<!DOCTYPE html>

<!--
  COLLABDESK PROTOTYPE:
  	Patricia Saylor
  	Divya Bajekal
  	Jonathan Lui
  	Benjamin Xie
  	
-->
<html>

<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
	<title>CollabDesk</title>

	<!-- Load style sheets -->
	<link rel="stylesheet" href="jquery-ui-1.10.2/themes/smoothness/jquery-ui.css" />
	<link rel="stylesheet" href="bootstrap/css/bootstrap.css" />

	<!-- Load any supplemental Javascript libraries here -->
	<script type="text/javascript" src="jquery-ui-1.10.2/jquery-1.9.1.js"></script>
	<script type="text/javascript" src="jquery-ui-1.10.2/ui/jquery-ui.js"></script>
	<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>

	<!-- Load our own Javascript files and stylesheets here -->
	<script type="text/javascript" src="message.js"></script>
	<script type="text/javascript" src="database.js"></script>
	<script type="text/javascript" src="preloadData.js"></script>
	<!--<script type="text/javascript" src="readMessage.js"></script> -->
	<script type="text/javascript" src="createMessage.js"></script>
	<script type="text/javascript" src="createReply.js"></script>
	<script type="text/javascript" src="search.js"></script>
	<script type="text/javascript" src="BrowsePane.js"></script>
	<link rel="stylesheet" href="styles.css" />

	<script type="text/javascript">
	$(document).ready(function(){
		var search = new Search();
		var browsePane = new BrowsePane();		
		$("tbody").append(browsePane.getAllMessageHTML(db));
		$("tbody").append(browsePane.getAllMessageHTML(db));
		$("tbody").append(browsePane.getAllMessageHTML(db));
		$("tbody").append(browsePane.getAllMessageHTML(db));		

		// $("body").css("overflow", "hidden");
		// example of creating a message and getting day and time
		var msg = new Message('LOST PACKAGE', 'Mary lost a package', 'Jiayi', ['tag1', 'tag2'], 'note', false, false);
		console.log(msg);

		// view the preloaded database
		console.log(db);
		// display a static message in the reading pane (until this is called from browsing pane)
		displayMessage(3);

		$("#cancelBtn").click(function() {
			reset();
		});

		$("#cancelBtn").click(function(e) {
			if (e.which == 13) {
				reset();
			}
		});

		/*
		Submits a reply when the reply button is clicked in the reading pane
		*/
		$(".replyButton").click(function() {
			$("#formTitle").html("Create Reply");
			openReplyForm();
		});

		/*
		Submits the form when the user clicks the Submit button
		*/
		$("#submitBtn").click(function() {
			$("#formTitle").html("New Message");
			submit();
		});

		/*
		Submits the form when the user has focus on the Submit button and presses enter
		*/
		$("#submitBtn").keydown(function (e) {
			if (e.which == 13) {
				submit();
			}
		});

		/***********
		* Listeners
		************/
		$("#search-tbox").keydown(function(event){
			if(event.which==13){ //checking for 'enter'
				var inp=$(this).val();
				console.log("Listening to ENTER. input is "+inp);
				console.log(search.getMessageIDs(inp,db));
			}
		});

		$("#search-tbox").autocomplete({
			source: function(request, response){
				//console.log("request");
				//console.log(request);
				response(search.getMessageTitles(request.term.toLowerCase(),db));
			}
		});
	});
	</script>

</head>

<body>

	<div class="loginHeader">
			<div class="floatLeft side">
				<h3 class="logo">CollabDesk</h3>
			</div>
			<div class="floatRight side">
				<div class="avatar side">
					<img class="avatar" src="images/generic_avatar.jpg"/>
				</div>
				<h3 class="side username">Sally</h3>
			</div>
			<div class="clear"></div>
	</div>

	<div class="container-fluid blue">
		<div class="container-spacing">

		<!-- browse pane -->
			<div class="browse pane floatLeftNoPadding left white">
				<div class="row-fluid">
					<div class="input-append span11	">
						<input type="text" class="input-block-level" id="search-tbox" autofocus />
						<span class="add-on btn"><i class="icon-search"></i></span>
					</div>
				</div>
				<div id="message-table">
					<table class ="table">
						<thead>
							<tr>
								Unread
							</tr>
						</thead>
						
						<tbody>
							<!--Messages added from db here-->						
						</tbody>
					</table>
				</div>
			</div>

		<!-- right side of layout: read and create -->		
		<div class="right">

		<!-- reading pane -->
            <div class="reading pane white">
                <div class="originalMsg">
                    <h4 class="originalMsgHeader">
                    	<div class="originalMsgTitle floatLeftNoPadding">Missing Package</div>
						<div class="high_pri floatRight"><img class="high_pri" src="images/high_pri.jpg"/></div>
						<div class="captain floatRight"><img class="captain" src="images/captain.jpg"/></div>
						<div class="clear"></div>
                    </h4>
                    <div class="originalMsgBody">
                    	<div class="originalMsgDetails"></div>
                    		<div class="authorPic"><img class="authorPic floatLeftNoPadding" src="images/generic_avatar.jpg"/></div>
                    		<div class="originalMsgDetailsText floatLeft"></div>
                    	<div class="originalMsgText offset1"></div>
                    </div>
                </div>
                <div class="replies"></div>
                <div class="alignBottom parentWidth">
                	<div class="hashtags">
                		<div class="tag">#tag1</div>
                	</div>
                	<button type="button" class="replyButton btn floatRight">Reply</button>
                </div>
            </div>

        <!-- gap between read and create panes -->
        <div class="gap"></div>


		<!-- create message pane -->
			<div class="create pane white">
			<form class="form">
			<fieldset>

			<!-- Form Name -->
			<legend id="formTitle">New Message
				<div class="floatRight btn"><i class="icon-chevron-down"></i></div>
			</legend>

			<!-- Select Template -->
			<div class="controls-row">
			<div class="span5">
				<div class="control-group">
				  	<label class="control-label"></label>
				  	<div class="controls">
				    <select id="selectTemplate" name="selectTemplate" class="input-xlarge">
				      	<option>Other...</option>
				      	<option>Missing Package</option>
				      	<option>Missing Person</option>
				    </select>
				  	</div>
				</div>

			<!-- Title -->
				<div class="control-group">
				  	<label class="control-label"></label>
				  	<div class="controls">
				    <input id="textinput" name="textinput" type="text" placeholder="Title" class="input-xlarge">
				    
				  	</div>
				</div>
			</div>

			<!-- Multiple Radios -->
			<div class="span4">
				<div class="control-group">
				  <div class="controls">
				    <label class="checkbox">
				      <input type="checkbox" class="note issue"value="Option one" checked="checked">
				      Note or Issue
				    </label>
				    <label class="checkbox">
				      <input type="checkbox" value="Option two">
				      High Priority
				    </label>
				    <label class="checkbox">
				      <input type="checkbox" value="Option two">
				      Alert Desk Captain
				    </label>
				  </div>
				</div>
			</div>
			</div>

			<!-- Message Text Area -->
				<div class="control-group controls-row">
					<div class="controls span8">                     
				    <textarea id="textarea" name="textarea" placeholder="Your message here..." class="input-block-level"></textarea>
				  	</div>
				</div>

			<!-- Tags -->
				<div class="control-group controls-row">
				  <div class="controls span8">
					<div class="input-prepend input-xlarge">
				    	<span class="add-on">#</span>
				    	<input id="prependedtext" name="prependedtext" class="" placeholder="#tags" type="text">
				    </div>
				    
				  </div>
				</div>

			<!-- Submit -->

				<div class="controls-row floatRight">
					<button type="button" id="submitBtn" class="btn btn-primary">Submit Message</button>
					<button type="button" id="cancelBtn" class="btn">Cancel</button>
				</div>
			</fieldset>
			</form>
		</div>
			</div>
		</div>

</div>

</body>

</html>